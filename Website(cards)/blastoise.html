<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Page - 3D Image Interaction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .product-image-container {
            perspective: 1000px;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 300px;
        }
        .product-image {
            transition: transform 0.1s ease-out;
            transform-style: preserve-3d;
            cursor: grab;
            width: 100%;
            max-width: 300px;
        }
        .comments-section {
            margin-top: 20px;
        }
        .comment {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-6">
                <div class="product-image-container">
                    <img src="img/poke3.jpeg" class="img-fluid product-image" alt="Blastoise Ex">
                </div>
            </div>
            <div class="col-md-6">
                <h2>Blastoise Ex</h2>
                <p><strong>Price:</strong> 2999.99</p>
                <p><strong>Description:</strong> Blastoise Ex is a powerful Pok√©mon card with a strong water-type attack, making it a favorite among trainers.</p>
                <button class="btn btn-warning">Buy Now</button>
                <hr>
                <h4>Customer Reviews</h4>
                <div id="comments" class="comments-section"></div>
                <textarea id="commentInput" class="form-control" placeholder="Write your review..."></textarea>
                <button onclick="addComment()" class="btn btn-success mt-2">Submit Review</button>
            </div>
        </div>
        <a href="index.html" class="btn btn-secondary mt-3">Back to Home</a>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const img = document.querySelector(".product-image");
            let isDragging = false, startX, startY, rotateX = 0, rotateY = 0;

            img.addEventListener("mousedown", (e) => {
                isDragging = true;
                startX = e.clientX - rotateY;
                startY = e.clientY - rotateX;
                img.style.cursor = "grabbing";
            });

            document.addEventListener("mousemove", (e) => {
                if (!isDragging) return;
                rotateY = (e.clientX - startX) / 10;
                rotateX = (e.clientY - startY) / 10;
                requestAnimationFrame(() => {
                    img.style.transform = `rotateY(${rotateY}deg) rotateX(${rotateX}deg)`;
                });
            });

            document.addEventListener("mouseup", () => {
                isDragging = false;
                img.style.cursor = "grab";
            });

            displayComments(); // Load stored comments
        });

        let loggedInUser = localStorage.getItem("loggedInUser") || "Guest";

        function addComment() {
            let commentInput = document.getElementById("commentInput");
            let commentText = commentInput.value.trim();
            if (commentText === "") {
                alert("Please enter a comment!");
                return;
            }

            let commentsSection = document.getElementById("comments");
            let newComment = document.createElement("div");
            newComment.classList.add("comment");
            newComment.innerHTML = `<strong>${loggedInUser}:</strong> ${commentText}`;
            commentsSection.appendChild(newComment);

            // Save comment in localStorage
            let storedComments = JSON.parse(localStorage.getItem("productComments")) || [];
            storedComments.push({ user: loggedInUser, text: commentText });
            localStorage.setItem("productComments", JSON.stringify(storedComments));

            commentInput.value = "";
        }

        function displayComments() {
            let commentsSection = document.getElementById("comments");
            let storedComments = JSON.parse(localStorage.getItem("productComments")) || [];

            storedComments.forEach(comment => {
                let newComment = document.createElement("div");
                newComment.classList.add("comment");
                newComment.innerHTML = `<strong>${comment.user}:</strong> ${comment.text}`;
                commentsSection.appendChild(newComment);
            });
        }
    </script>
</body>
</html>
